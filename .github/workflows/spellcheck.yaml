name: Spellcheck Task
on: [ pull_request ]
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true
jobs:
  collect_changes:
    name: Collect changed files
    outputs:
      any_changed: ${{ steps.check_files.outputs.any_changed }}
      changed_files: ${{ steps.check_files.outputs.changed_files }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout codebase
        uses: actions/checkout@v3
      - name: Get Changed Files
        id: files
        uses: tj-actions/changed-files@v41
        with:
          files: |
            ./public/*.html
            ./public/*.txt
            ./public/*.json
            ./src/**/*.html
            ./src/**/*.json
            ./src/**/*.ts
            ./src/**/*.tsx
  spellcheck:
    name: Run spellchecker
    needs: collect_changes
    if: needs.collect_changes.outputs.any_changed == 'true'
    uses: ./.github/workflows/spellchecker.yaml
    with:
      files: ${{ needs.collect_changes.outputs.all_changed_files }}
